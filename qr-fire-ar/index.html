<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Fire AR - ç‚ã®ARä½“é¨“</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
            font-size: 14px;
            max-width: 300px;
        }
        #info h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
        }
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            z-index: 999;
        }
    </style>
</head>
<body>
    <div id="info">
        <h3>ğŸ”¥ QR Fire AR</h3>
        <p id="status">Hiroãƒãƒ¼ã‚«ãƒ¼ã‚’ã‚«ãƒ¡ãƒ©ã«å‘ã‘ã¦ãã ã•ã„</p>
        <p id="debug">å¾…æ©Ÿä¸­...</p>
    </div>

    <div class="loading" id="loading">
        <p>ã‚«ãƒ¡ãƒ©ã‚’åˆæœŸåŒ–ä¸­...</p>
    </div>

    <a-scene
        embedded
        arjs="sourceType: webcam; debugUIEnabled: true;"
        vr-mode-ui="enabled: false"
    >
        <!-- ç’°å¢ƒå…‰ã‚’è¿½åŠ  -->
        <a-light type="ambient" color="#fff" intensity="1"></a-light>

        <!-- ã‚«ãƒ¡ãƒ© -->
        <a-entity camera></a-entity>

        <!-- QRãƒãƒ¼ã‚«ãƒ¼ï¼ˆHiro ãƒãƒ¼ã‚«ãƒ¼ã‚’ä½¿ç”¨ï¼‰ -->
        <a-marker preset="hiro" marker-handler>
            <!-- ç‚ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼ˆç™ºå…‰ã™ã‚‹ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã‚’ä½¿ç”¨ï¼‰ -->
            <a-sphere
                id="fire-base"
                position="0 0.2 0"
                radius="0.3"
                material="color: #FF4500; shader: flat; emissive: #FF4500; emissiveIntensity: 1"
                animation="property: scale; to: 1.2 1.5 1.2; loop: true; dir: alternate; dur: 500; easing: easeInOutQuad"
            ></a-sphere>

            <a-sphere
                position="0 0.5 0"
                radius="0.25"
                material="color: #FFD700; shader: flat; emissive: #FFD700; emissiveIntensity: 1"
                animation="property: scale; to: 1.3 1.6 1.3; loop: true; dir: alternate; dur: 400; easing: easeInOutQuad"
            ></a-sphere>

            <a-sphere
                position="0 0.8 0"
                radius="0.2"
                material="color: #FF6600; shader: flat; emissive: #FF6600; emissiveIntensity: 1"
                animation="property: scale; to: 1.4 1.7 1.4; loop: true; dir: alternate; dur: 350; easing: easeInOutQuad"
            ></a-sphere>

            <a-sphere
                position="0 1.0 0"
                radius="0.15"
                material="color: #FFFF00; shader: flat; emissive: #FFFF00; emissiveIntensity: 1"
                animation="property: scale; to: 1.5 1.8 1.5; loop: true; dir: alternate; dur: 300; easing: easeInOutQuad"
            ></a-sphere>

            <!-- æºã‚‰ãã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ -->
            <a-sphere
                position="0 0.3 0"
                radius="0.15"
                material="color: #FF0000; shader: flat; emissive: #FF0000; emissiveIntensity: 1; opacity: 0.7"
                animation__pos="property: position; to: -0.1 0.6 0; loop: true; dir: alternate; dur: 600; easing: easeInOutSine"
                animation__scale="property: scale; to: 0.8 1.2 0.8; loop: true; dir: alternate; dur: 400"
            ></a-sphere>

            <a-sphere
                position="0 0.3 0"
                radius="0.15"
                material="color: #FF0000; shader: flat; emissive: #FF0000; emissiveIntensity: 1; opacity: 0.7"
                animation__pos="property: position; to: 0.1 0.7 0; loop: true; dir: alternate; dur: 700; easing: easeInOutSine"
                animation__scale="property: scale; to: 0.9 1.3 0.9; loop: true; dir: alternate; dur: 450"
            ></a-sphere>

            <!-- å…‰æº -->
            <a-light type="point" intensity="2" color="#FF4500" distance="5" position="0 0.5 0"></a-light>
        </a-marker>
    </a-scene>

    <script>
        // ãƒ‡ãƒãƒƒã‚°ç”¨ã®çŠ¶æ…‹è¡¨ç¤º
        const statusEl = document.getElementById('status');
        const debugEl = document.getElementById('debug');

        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã®åˆ¶å¾¡
        window.addEventListener('load', () => {
            debugEl.textContent = 'ã‚«ãƒ¡ãƒ©åˆæœŸåŒ–ä¸­...';
            setTimeout(() => {
                const loading = document.getElementById('loading');
                if (loading) {
                    loading.style.display = 'none';
                }
                debugEl.textContent = 'ã‚«ãƒ¡ãƒ©èµ·å‹•å®Œäº† - ãƒãƒ¼ã‚«ãƒ¼ã‚’æ¢ã—ã¦ã„ã¾ã™';
            }, 3000);
        });

        // ãƒãƒ¼ã‚«ãƒ¼æ¤œå‡ºæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ
        AFRAME.registerComponent('marker-handler', {
            init: function() {
                console.log('marker-handler initialized');
                debugEl.textContent = 'ãƒãƒ¼ã‚«ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼æº–å‚™å®Œäº†';

                this.el.addEventListener('markerFound', () => {
                    console.log('ğŸ”¥ ãƒãƒ¼ã‚«ãƒ¼ã‚’æ¤œå‡ºã—ã¾ã—ãŸï¼');
                    statusEl.textContent = 'âœ… ãƒãƒ¼ã‚«ãƒ¼æ¤œå‡ºï¼ç‚ãŒè¡¨ç¤ºã•ã‚Œã¾ã™';
                    statusEl.style.color = '#00ff00';
                    debugEl.textContent = 'ç‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤ºä¸­';
                });

                this.el.addEventListener('markerLost', () => {
                    console.log('âŒ ãƒãƒ¼ã‚«ãƒ¼ã‚’è¦‹å¤±ã„ã¾ã—ãŸ');
                    statusEl.textContent = 'Hiroãƒãƒ¼ã‚«ãƒ¼ã‚’ã‚«ãƒ¡ãƒ©ã«å‘ã‘ã¦ãã ã•ã„';
                    statusEl.style.color = '#ffffff';
                    debugEl.textContent = 'ãƒãƒ¼ã‚«ãƒ¼ã‚’æ¢ã—ã¦ã„ã¾ã™...';
                });
            }
        });

        // AR.jsã®èª­ã¿è¾¼ã¿çŠ¶æ…‹ã‚’ç¢ºèª
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOMContentLoaded');
            debugEl.textContent = 'AR.jsã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...';
        });

        // A-Frameã®èª­ã¿è¾¼ã¿å®Œäº†
        window.addEventListener('arjs-nft-loaded', () => {
            console.log('AR.js loaded');
            debugEl.textContent = 'AR.jsèª­ã¿è¾¼ã¿å®Œäº†';
        });
    </script>
</body>
</html>
